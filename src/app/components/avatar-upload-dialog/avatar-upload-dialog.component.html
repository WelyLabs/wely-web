<div class="dialog-container">
    <div class="dialog-header">
        <h2>Photo de profil</h2>
        <button class="close-button" (click)="close()">
            <mat-icon>close</mat-icon>
        </button>
    </div>

    <div class="content">
        <div class="upload-area" *ngIf="!imageChangedEvent">
            <div class="upload-placeholder" (click)="fileInput.click()">
                <mat-icon>add_a_photo</mat-icon>
                <span>Choisir une image</span>
            </div>
        </div>

        <div class="cropper-area" *ngIf="imageChangedEvent">
            <image-cropper [imageChangedEvent]="imageChangedEvent" [maintainAspectRatio]="true" [aspectRatio]="1 / 1"
                format="png" (imageCropped)="imageCropped($event)" (imageLoaded)="imageLoaded($event)"
                (cropperReady)="cropperReady()" (loadImageFailed)="loadImageFailed()" [transform]="{ scale: scale }"
                class="cropper"></image-cropper>
        </div>

        <input type="file" (change)="fileChangeEvent($event)" #fileInput style="display: none" accept="image/*" />

        <div class="controls" *ngIf="imageChangedEvent">
            <mat-icon>remove</mat-icon>
            <mat-slider min="0.5" max="3" step="0.1" [discrete]="false">
                <input matSliderThumb [(ngModel)]="scale" (valueChange)="scale = $event">
            </mat-slider>
            <mat-icon>add</mat-icon>
        </div>
    </div>

    <div class="actions">
        <button mat-button (click)="close()">Annuler</button>
        <button mat-flat-button color="primary" (click)="save()" [disabled]="!imageChangedEvent || isLoading">
            {{ isLoading ? 'Enregistrement...' : 'Enregistrer' }}
        </button>
    </div>
</div>